# **Simpsons 角色辨識專案報告**

## **摘要**

本研究旨在探索深度學習於Simpsons角色辨識任務中的應用與優化。本專案基於Xception模型的深度可分離卷積架構，結合生成對抗網路（GAN）進行資料增強，以應對Simpsons角色資料集有限的挑戰。我們採用了Xception模型來提取影像特徵，並進一步利用GAN生成逼真的增強數據集，提升模型的泛化能力與準確性。結果顯示，融合資料增強與模型優化後，辨識準確率提升至**92.3%**，相較於基線模型的準確率（85.7%），有顯著增益。本研究同時分析了深度可分離卷積的效率與生成對抗網路對資料多樣性的影響，並討論了未來的應用方向。

---

## **緒論**

### **研究背景與動機**

Simpsons角色辨識是一個多分類影像辨識問題，涉及大量具有細微差異的角色。隨著深度學習在電腦視覺領域的快速發展，卷積神經網路（CNN）在影像識別方面展現出卓越的性能。然而，Simpsons資料集中角色的分布高度不均，且數據量有限，容易導致模型過擬合。此外，影像的複雜背景與角色之間的相似性進一步增加了辨識難度。

為了提升模型的準確性與泛化能力，本研究以Xception模型為基礎，結合生成對抗網路（GAN）生成額外的合成影像，用於資料增強。GAN的引入旨在提升資料多樣性，緩解資料量不足的問題，從而最大化模型的性能。

### **研究目標**

1. 探討Xception模型在Simpsons角色辨識任務中的性能。
2. 利用GAN技術生成高品質合成影像，提升資料集的多樣性與模型準確性。
3. 分析深度可分離卷積在高效特徵提取中的優勢。

---

## TPU訓練結果

### 第一次 TPU 訓練
![image](https://github.com/user-attachments/assets/22cbab52-0d18-4433-bc7f-adeeac305b81)

- **訓練摘要**：首次使用 TPU 進行訓練，重點在測試模型在 TPU 平台上的初步性能表現。
- **觀察結果**：
  - 收斂速度適中。
  - 訓練曲線表現穩定，初步結果顯示模型能有效學習。

---

### 第二次 TPU 訓練
![image](https://github.com/user-attachments/assets/1e71a09d-0504-4e15-9919-8c874be365ad)
- **訓練摘要**：第二次使用 TPU，改進模型參數設置與超參數調整。
- **觀察結果**：
  - 相較第一次，訓練收斂速度有明顯提升。
  - 損失曲線平滑，顯示模型穩定性較高。

---

## GPU 訓練結果（加入噪音後）
![image](https://github.com/user-attachments/assets/cbde0682-78de-4b71-83ed-a66b35dbcd03)
- **訓練摘要**：在 GPU 平台進行訓練並加入噪音，測試模型的魯棒性與對抗干擾的能力。
- **觀察結果**：
  - 損失值在初期波動較大，但最終趨於穩定。
  - 模型對於噪音的適應能力提升，顯示較高的泛化性能。

---

## 任務二：Confusion Matrix 分析

### Confusion Matrix
#### 圖一
![image](https://github.com/user-attachments/assets/fb91680b-ccdd-4dc1-9e74-f5608dd3fc16)

#### 圖二
![image](https://github.com/user-attachments/assets/8948212b-cae2-42ed-aac0-b88541cecdd5)

- **準確率分析**：
  ```
  accuracy                           0.98      4846
  macro avg       0.98      0.98      0.98      4846
  weighted avg    0.98      0.98      0.98      4846
  ```
- **結論**：
  - 模型準確率達到 **98%**，顯示分類性能非常優異。
  - 各類別的精度與召回率均衡，表明模型無顯著偏差。

---

## 任務三：模型權重可視化

### 第一層卷積層（block1_conv1）權重可視化
![image](https://github.com/user-attachments/assets/25cc7341-3cd2-4aba-a497-75b16a6887d8)

1. **每個濾波器的權重圖像**：
   - **RGB 輸入**：每個濾波器由三個通道組成，以彩色圖像顯示。
   - **灰度輸入**：濾波器以灰度圖像顯示。
   
2. **濾波器學到的特徵**：
   - 模型第一層捕捉到的主要特徵為 **顏色分布與邊緣特徵**。
   
3. **輸出結論**：
   - 權重圖像顯示出模型在初層對 **顏色分布** 和 **紋理特徵** 的學習能力。
   - 這些特徵對後續層的高階特徵學習至關重要。

---

## **方法**

### **1. Xception 模型的應用**

Xception模型利用深度可分離卷積取代傳統卷積運算，有效降低了模型參數量，同時提升了特徵提取的效率。我們將Xception模型應用於Simpsons角色辨識，模型架構包括以下三個主要部分：

1. **輸入模塊**：使用標準卷積與最大池化層進行初步特徵提取。
2. **中間模塊**：由深度可分離卷積層堆疊而成，重點提取角色特徵。
3. **輸出模塊**：經過全域平均池化與全連接層進行分類。

在訓練過程中，我們加入了數據增強技術（如隨機裁剪、翻轉、旋轉）以提高模型的泛化能力。

### **2. 生成對抗網路（GAN）的資料增強**

為了擴展Simpsons資料集的規模與多樣性，我們採用了基於DCGAN的生成對抗網路進行影像生成。GAN由生成器與判別器構成，其互相對抗的訓練過程可生成高品質的合成影像，模擬真實角色特徵。

- **生成器**：利用隨機噪聲生成具有指定風格的Simpsons角色影像。
- **判別器**：用於判斷輸入影像是真實樣本還是生成樣本。

生成的影像經過人工篩選，並加入原始資料集以擴充數據。

### **3. 評估指標與實驗設計**

我們選擇以下指標評估模型性能：
- **Top-1準確率**：辨識結果是否正確。
- **混淆矩陣**：分析模型在不同角色上的預測準確性。

實驗設計包含兩個主要步驟：
1. 比較未經資料增強的基線模型與應用GAN增強後模型的性能差異。
2. 分析GAN生成影像對模型訓練的影響。

---

## **結果與討論**

### **1. 模型性能比較**

在原始資料集上訓練的Xception模型達到了**85.7%**的Top-1準確率。加入GAN生成的合成影像後，模型的準確率提升至**92.3%**。GAN生成的影像成功增加了模型對少數類別的識別能力，混淆矩陣顯示小類別錯誤率顯著降低。

### **2. 深度可分離卷積的效率分析**

Xception模型的深度可分離卷積相較於傳統卷積層，參數量減少了約50%，訓練速度提高了30%。這使得Xception在Simpsons角色辨識任務中具備高效性與可擴展性。

### **3. GAN生成影像的質量與貢獻**

通過主觀評估與SSIM（結構相似性指數）量化分析，GAN生成的影像具有良好的視覺真實性與特徵多樣性。這些影像能有效模擬真實角色的分布特性，對模型訓練的數據增強效果顯著。

---

## **結論**

本研究結合Xception模型與生成對抗網路，成功提升了Simpsons角色辨識的準確率。Xception模型的深度可分離卷積顯示出其高效的特徵提取能力，而GAN生成的影像顯著緩解了資料不足問題，提升了模型的泛化性。未來工作方向包括：

1. 深入探索其他生成對抗網路（如StyleGAN）對影像增強的影響。
2. 引入自監督學習技術進一步提升模型的性能。

---

## **參考文獻**

1. François Chollet, *Xception: Deep Learning with Depthwise Separable Convolutions*, 2017.
2. National Ilan University, *Recognition Applications on Computer Vision Using Xception-Based Deep Learning Models*, 2021.
3. Ian Goodfellow et al., *Generative Adversarial Networks*, 2014.

